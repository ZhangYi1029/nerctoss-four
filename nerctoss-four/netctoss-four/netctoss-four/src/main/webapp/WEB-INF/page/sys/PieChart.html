<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="description" content="">
<title>颜色渐变的饼图</title>
<script src="${rc.contextPath}/statics/plugins/code/lib/jquery-1.8.3.min.js"></script>

<script src="${rc.contextPath}/statics/plugins/code/highcharts.js"></script>


<script type="text/javascript">
	
</script>


</head>


<body>
	<!--
*************************************************************************
    Generated by HCODE at 2017-05-05 12:26:13
    From: https://code.hcharts.cn/demos/hhhhD1
*************************************************************************
-->
	<fieldset>
		<legend>饼状表查询</legend>

		<label>年查询:</label>&nbsp;&nbsp;&nbsp;&nbsp; <select id="sel"></select><label>年</label></br>
		</br> <label>账务账号:</label> <input type="text" name="number" id="number"></br>
		</br>

		<button id="btn" onclick="javascript:chartAjax()">查询</button>

	</fieldset>
	</br>
	</br>








	<div id="container" style="min-width: 400px; height: 400px"></div>



	<script>
	
		for (var i = 1950; i < 2050; i++) {

			if (i == '2017') {
				$('#sel').append(
						"<option value='"+i+"' selected='selected'>" + i
								+ "</option>")
				continue;
			}

			$('#sel').append("<option value='"+i+"'>" + i + "</option>")

		};

		function chartAjax() {

			var sel = $('#sel  option:selected').val();

			var number = $('#number').val();

			console.info(sel + number);

			if (number == null || number == '') {

				return alert("账务账号不能为空");
			}

			$
					.ajax({
						type : 'POST',
						url : '/netctoss-four/chart/pie',
						async : true,
						data : {
							'year' : sel,
							'number' : number
						},
						success : function(data) {

							console.info("AJAX");

							var arr = [];
							for (var i = 0; i < data.length; i++) {
								console.info(data[i]);
								arr[i] = [ data[i].month, data[i].expense ];
							}

							console.info(arr);
							/* var ar = [ {
								type : 'pie',
								name : '浏览器占比',
								data : arr

							} ]; */

							$('#container').highcharts().series[0].setData(arr);  
							$('#container').highcharts().series[0].setSize(200,200);  
							$('#container').highcharts().series[0].hideLoading();  

							console.info($('#container').highcharts().series[0]);
							/*  console.info("ajax");
							  $('#container').highcharts({series:arr}); */

						}
					})

		}
		
		
		$(function() {
			// Radialize the colors
			Highcharts.getOptions().colors = Highcharts
					.map(
							Highcharts.getOptions().colors,
							function(color) {
								return {
									radialGradient : {
										cx : 0.5,
										cy : 0.3,
										r : 0.7
									},
									stops : [
											[ 0, color ],
											[
													1,
													Highcharts
															.Color(
																	color)
															.brighten(
																	-0.3)
															.get(
																	'rgb') ] // darken
									]
								};
							});
			// 构建图表
			$('#container')
					.highcharts(
							{
								chart : {
									plotBackgroundColor : null,
									plotBorderWidth : null,
									plotShadow : false
								},
								title : {
									text : '年中月账单占比'
								},
								tooltip : {
									pointFormat : '{series.name}: <b>{point.percentage:.1f}%</b>'
								},
								plotOptions : {
									pie : {
										allowPointSelect : true,
										cursor : 'pointer',
										dataLabels : {
											enabled : true,
											format : '<b>{point.name}</b>: {point.percentage:.1f} %',
											style : {
												color : (Highcharts.theme && Highcharts.theme.contrastTextColor)
														|| 'black'
											},
											connectorColor : 'silver'
										}
									}
								},
								series : [ {
									type : 'pie',
									name : '浏览器占比',
									data : null

								} ]
							});

		});
		
	</script>


</body>
</html>
<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="description" content="">
<title>基础直线图</title>

<script src="${rc.contextPath}/statics/plugins/code/lib/jquery-1.8.3.min.js"></script>
<script src="${rc.contextPath}/statics/plugins/code/highcharts.js"></script>
<script src="${rc.contextPath}/statics/plugins/code/modules/exporting.js"></script>
<script src="${rc.contextPath}/statics/plugins/code/highcharts-zh_CN.js"></script> 
</head>
<body>
<!--
*************************************************************************
    Generated by HCODE at 2017-05-05 15:37:51
    From: https://code.hcharts.cn/demos/hhhhxL
*************************************************************************
-->


<fieldset>
		<legend>折线表查询</legend>

		<label>年查询:</label>&nbsp;&nbsp;&nbsp;&nbsp; <select id="sel"></select><label>年</label></br>
		</br> <label>账务账号:</label> <input type="text" name="number" id="number"></br>
		</br>

		<button id="btn" onclick="javascript:lineAjax()">查询</button>

	</fieldset>
	</br>
	</br>


<div id="container" style="min-width:400px;height:400px"></div>


	<script>
	/**
  * Highcharts 在 4.2.0 开始已经不依赖 jQuery 了，直接用其构造函数既可创建图表
 **/
 
 for (var i = 1950; i < 2050; i++) {

		if (i == '2017') {
			$('#sel').append(
					"<option value='"+i+"' selected='selected'>" + i
							+ "</option>")
			continue;
		}

		$('#sel').append("<option value='"+i+"'>" + i + "</option>")

	};

 
 
 
var chart = new Highcharts.Chart('container', {
    title: {
        text: '年账务账号下月业务账号使用折线图',
        x: -20
    }
    
});
	
	
 function lineAjax(){
		
	 
	 var sel = $('#sel  option:selected').val();

		var number = $('#number').val();

	

		if (number == null || number == '') {

			return alert("账务账号不能为空");
		}

		
		$.ajax({
			type : 'POST',
			url : '/netctoss-four/chart/line',
			async : true,
			 data : {
				'year' : sel,
				'number' : number
			},
			success : function(data) {
		
				
				var a=[];
				var monthArr=[];
				for(var s =1 ;s<=12 ;s++){
					
					if(s<10){
						
						monthArr[s-1]=sel+'-0'+s;
										
					}
					else{
						monthArr[s-1]=sel+'-'+s;	
						
					}
					
					
				}
			
				
				for (var j= 0; j < data.length; j++) {
					var y=[];
					var obj=data[j];
					
					for(var g =0 ; g<obj.length;g++){
						
					
						
						for (var k = 0; k <= 11; k++) {	
							
							if(obj[g].month==monthArr[k]){
								y[k]=obj[g].expense;
								
								continue;
							}else if(y[k]==null||y[k]==0){
								y[k]=0;
							}							
						}
					}
					
				
					var brr={ name:'业务账号:'+obj[0].number+' 资费' , data: y};
					
					
					a[j]=brr;
				}
				
				$('#container').highcharts({
					title: {
				        text: '年账务账号下月业务账号使用折线图',
				        x: -20
				    },
				     subtitle: {
				        text: '',
				        x: -20
				    }, 
				    xAxis: {
				        categories: ['一月', '二月', '三月', '四月', '五月', '六月', '七月', '八月', '九月', '十月', '十一月', '十二月']
				    },
				    yAxis: {
				        title: {
				            text: '单位(元)'
				        },
				        plotLines: [{
				            value: 0,
				            width: 1,
				            color: '#808080'
				        }]
				    },
				    tooltip: {
				        valueSuffix: '元'
				        
				    },
				    legend: {
				        layout: 'vertical',
				        align: 'right',
				        verticalAlign: 'middle',
				        borderWidth: 0
				    },
					series:a
					
					
				})
				
				/*  var arr = [[7.0, 6.9, 9.5, 14.5, 18.2, 21.5, 25.2, 26.5, 23.3, 18.3, 13.9, 9.6]];
				console.info( chart.series[0]);
				
				 chart.series[0].setName("背景");
				chart.series[0].setData(arr);
				chart.series[0].setSize(200,200);  
				chart.series[0].hideLoading();   */
				 
				/* console.info(chart); */
				chart.hideLoading();
				/* chart.series.setData(arr);
				console.info(chart.series.setData());
				console.info("试过"); */
				console.info($('#container').highcharts() );
				
			}}
			);
	} 
	
	
	
</script>

</body></html>